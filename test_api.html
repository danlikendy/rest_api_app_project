<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organizations API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .endpoint {
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            border-radius: 4px;
        }
        .endpoint h3 {
            margin: 0 0 10px 0;
            color: #007bff;
        }
        .endpoint button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        .endpoint button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            background: #e9ecef;
            border-radius: 4px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
        }
        .success {
            background: #d4edda;
            color: #155724;
        }
        input, select {
            padding: 5px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè¢ Organizations Directory API Test</h1>
        <p><strong>API Base URL:</strong> http://localhost:8000</p>
        <p><strong>API Key:</strong> your-secret-api-key-here</p>
    </div>

    <div class="container">
        <div class="endpoint">
            <h3>1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</h3>
            <button onclick="testEndpoint('/organizations')">GET /organizations</button>
            <div id="result1" class="result"></div>
        </div>

        <div class="endpoint">
            <h3>2. –ü–æ–ª—É—á–∏—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –ø–æ ID</h3>
            <input type="number" id="orgId" placeholder="ID –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏" value="1">
            <button onclick="testEndpoint(`/organizations/${document.getElementById('orgId').value}`)">GET /organizations/{id}</button>
            <div id="result2" class="result"></div>
        </div>

        <div class="endpoint">
            <h3>3. –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é</h3>
            <input type="text" id="searchName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" value="–†–æ–≥–∞">
            <button onclick="testEndpoint(`/organizations/search/name?name=${encodeURIComponent(document.getElementById('searchName').value)}`)">–ü–æ–∏—Å–∫</button>
            <div id="result3" class="result"></div>
        </div>

        <div class="endpoint">
            <h3>4. –ü–æ–∏—Å–∫ –ø–æ –≤–∏–¥—É –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π)</h3>
            <select id="activityId">
                <option value="1">–ï–¥–∞ (—É—Ä–æ–≤–µ–Ω—å 1)</option>
                <option value="2">–ú—è—Å–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è (—É—Ä–æ–≤–µ–Ω—å 2)</option>
                <option value="5">–ê–≤—Ç–æ–º–æ–±–∏–ª–∏ (—É—Ä–æ–≤–µ–Ω—å 1)</option>
                <option value="7">–õ–µ–≥–∫–æ–≤—ã–µ (—É—Ä–æ–≤–µ–Ω—å 2)</option>
                <option value="8">–ó–∞–ø—á–∞—Å—Ç–∏ (—É—Ä–æ–≤–µ–Ω—å 3)</option>
            </select>
            <button onclick="testEndpoint(`/organizations/activity/${document.getElementById('activityId').value}`)">–ü–æ–∏—Å–∫</button>
            <div id="result4" class="result"></div>
        </div>

        <div class="endpoint">
            <h3>5. –ü–æ–∏—Å–∫ –≤ —Ä–∞–¥–∏—É—Å–µ</h3>
            <input type="number" id="lat" placeholder="–®–∏—Ä–æ—Ç–∞" value="55.7558" step="0.0001">
            <input type="number" id="lng" placeholder="–î–æ–ª–≥–æ—Ç–∞" value="37.6176" step="0.0001">
            <input type="number" id="radius" placeholder="–†–∞–¥–∏—É—Å (–∫–º)" value="5" step="0.1">
            <button onclick="testEndpoint(`/organizations/search/radius?latitude=${document.getElementById('lat').value}&longitude=${document.getElementById('lng').value}&radius_km=${document.getElementById('radius').value}`)">–ü–æ–∏—Å–∫</button>
            <div id="result5" class="result"></div>
        </div>

        <div class="endpoint">
            <h3>6. –ü–æ–∏—Å–∫ –≤ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏</h3>
            <input type="number" id="minLat" placeholder="–ú–∏–Ω. —à–∏—Ä–æ—Ç–∞" value="55.7" step="0.0001">
            <input type="number" id="maxLat" placeholder="–ú–∞–∫—Å. —à–∏—Ä–æ—Ç–∞" value="55.8" step="0.0001">
            <input type="number" id="minLng" placeholder="–ú–∏–Ω. –¥–æ–ª–≥–æ—Ç–∞" value="37.6" step="0.0001">
            <input type="number" id="maxLng" placeholder="–ú–∞–∫—Å. –¥–æ–ª–≥–æ—Ç–∞" value="37.7" step="0.0001">
            <button onclick="testEndpoint(`/organizations/search/rectangle?min_latitude=${document.getElementById('minLat').value}&max_latitude=${document.getElementById('maxLat').value}&min_longitude=${document.getElementById('minLng').value}&max_longitude=${document.getElementById('maxLng').value}`)">–ü–æ–∏—Å–∫</button>
            <div id="result6" class="result"></div>
        </div>

        <div class="endpoint">
            <h3>7. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–¥–∞–Ω–∏—è</h3>
            <button onclick="testEndpoint('/buildings')">GET /buildings</button>
            <div id="result7" class="result"></div>
        </div>

        <div class="endpoint">
            <h3>8. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –≤–∏–¥—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
            <button onclick="testEndpoint('/activities')">GET /activities</button>
            <div id="result8" class="result"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';
        const API_KEY = 'your-secret-api-key-here';

        async function testEndpoint(endpoint) {
            const resultId = `result${endpoint.match(/\d+/)?.[0] || '1'}`;
            const resultDiv = document.getElementById(resultId);
            
            resultDiv.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
            resultDiv.className = 'result';

            try {
                const response = await fetch(`${API_BASE}${endpoint}`, {
                    method: 'GET',
                    headers: {
                        'X-API-Key': API_KEY,
                        'Content-Type': 'application/json'
                    },
                    mode: 'cors'
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                resultDiv.className = 'result success';
                
            } catch (error) {
                resultDiv.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
                resultDiv.className = 'result error';
                console.error('API Error:', error);
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            testEndpoint('/organizations');
        };
    </script>
</body>
</html>
